newgui repositories [
  guititle "Content Repositories"
  guibar
  guilist [
    guilist [
      loopfiles _repositories_name "repositories" "" [
        if (&& (&& (! (strcmp $_repositories_name ".")) (! (strcmp $_repositories_name ".."))) (! (strcmp $_repositories_name ".svn"))) [
          guitext @_repositories_name
        ]
      ]
    ]
    guilist [
      loopfiles _repositories_name "repositories" "" [
        if (&& (&& (! (strcmp $_repositories_name ".")) (! (strcmp $_repositories_name ".."))) (! (strcmp $_repositories_name ".svn"))) [
          if (strcmp @_repositories_name "sauerbomber-base") [
            guitext "internal"
          ] [
            guibutton "update" [
              showgui repositoryprogress
              sleep 250 [
                repositoryupdate @@@_repositories_name
              ]
            ]
          ]
        ]
      ]
    ]
  ]
  guibar
  guititle "Add repository"
  guilist [
    guitext "name"
    guifield _repositories_add_name
  ]
  guilist [
    guitext "url"
    guifield _repositories_add_url
  ]
  guibutton "Add" [
    showgui repositoryprogress
    repositorycheckout $_repositories_add_name $_repositories_add_url
  ]
]

newgui "repositoryprogress" [
  guititle "Updating the repository"
  guibar
  guititle "PLEASE WAIT"
  guibar
  guibutton "Close" [
    cleargui
  ]
]